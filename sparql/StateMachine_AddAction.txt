PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> 
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX factory: <https://w3id.org/ontoeng/factory#>
PREFIX osph: <https://w3id.org/ontoeng/osph#>
PREFIX fsm: <http://www.learninglab.de/~dolog/fsm/fsm.owl#>
PREFIX ifcext: <https://w3id.org/ontoeng/IFC4_ADD1_extension#>
PREFIX cs: <https://w3id.org/ontoeng/controlSystem#>
PREFIX ex: <https://w3id.org/ontoeng/expression#>
PREFIX express: <https://w3id.org/express#> 

DELETE{
	GRAPH ?g0{?action osph:hasActionDelay ?delayOLD .}
	GRAPH ?g1{?action osph:hasActionDuration ?durationOLD .}
	GRAPH ?g2{?action osph:hasActionTarget ?targetOLD .}
	GRAPH ?g3{?action osph:hasActionLocation ?positionOLD .}
	GRAPH ?g4{?action osph:hasActionRotation ?rotationOLD .}
	GRAPH ?g5{?action osph:hasActionVelocity ?velocityOLD .}
	GRAPH ?g51{?action osph:isActionInLoop ?loopOLD .}
	GRAPH ?g6{?action osph:hasActionReprRef ?reprrefOLD .}
	GRAPH ?g7{?action osph:hasActionReprColor ?reprcolorOLD .}
	GRAPH ?g8{?action osph:hasActionReprIntensity ?reprintensityOLD .}	
	GRAPH ?g9{?action osph:hasActionReprBlinkInterval ?reprblinkOLD .}	
}
INSERT { 
	GRAPH ?graph { 
		?statemach fsm:contains ?action .
		
		?stateEntry fsm:Entry ?action .
		?stateExit fsm:Exit ?action .	
		?transition osph:hasTransitionAction ?action .	

		?action osph:hasActionDelay ?delay .
		?action osph:hasActionDuration ?duration .
		?action osph:hasActionTarget ?target .
		
		?action osph:hasActionLocation ?position .
		?action osph:hasActionRotation ?rotation .
		?action osph:hasActionVelocity ?velocity .
		
		?action osph:isActionInLoop ?loop .
	
		?action osph:hasActionReprRef ?reprref .
		?action osph:hasActionReprColor ?reprcolor .
		?action osph:hasActionReprIntensity ?reprintensity .	
		?action osph:hasActionReprBlinkInterval ?reprblink .	
	}
}
WHERE{

	#?statemach rdf:type fsm:StateMachine .
	?action rdf:type/rdfs:subClassOf* fsm:Action .

	OPTIONAL { 
		FILTER(BOUND(?delay))
		GRAPH ?g0{?action osph:hasActionDelay ?delayOLD .}
	}
	OPTIONAL { 
		FILTER(BOUND(?duration))
		GRAPH ?g1{?action osph:hasActionDuration ?durationOLD .}
	}
	OPTIONAL { 
		FILTER(BOUND(?target))
		GRAPH ?g2{?action osph:hasActionTarget ?targetOLD .}
	}
	OPTIONAL { 
		FILTER(BOUND(?position))
		GRAPH ?g3{?action osph:hasActionLocation ?positionOLD .}
	}
	OPTIONAL { 
		FILTER(BOUND(?rotation))
		GRAPH ?g4{?action osph:hasActionRotation ?rotationOLD .}
	}
	OPTIONAL { 
		FILTER(BOUND(?velocity))
		GRAPH ?g5{?action osph:hasActionVelocity ?velocityOLD .}
	}
	OPTIONAL { 
		FILTER(BOUND(?loop))
		GRAPH ?g51{?action osph:isActionInLoop ?loopOLD .}
	}
	OPTIONAL { 
		FILTER(BOUND(?reprref))
		GRAPH ?g6{?action osph:hasActionReprRef ?reprrefOLD .}
	}
	OPTIONAL { 
		FILTER(BOUND(?reprcolor))
		GRAPH ?g7{?action osph:hasActionReprColor ?reprcolorOLD .}
	}
	OPTIONAL { 
		FILTER(BOUND(?reprintensity))
		GRAPH ?g8{?action osph:hasActionReprIntensity ?reprintensityOLD .}
	}
	OPTIONAL { 
		FILTER(BOUND(?reprblink))
		GRAPH ?g9{?action osph:hasActionReprBlinkInterval ?reprblinkOLD .}
	}		
}
